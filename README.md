# π¤– MCRP-demo

ν•΄λ‹Ή μ‹μ¤ν…μ€ Neeko (https://github.com/weiyifan1023/Neeko) ν”„λ μ„μ›ν¬λ΅ ν›λ ¨λ λ¨λΈμ„ μ„λΉ™ν•λ” API μ„λ²„μ™€ ν†µμ‹ ν•λ” μ›Ή μ„λ²„ μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤.
Neeko ν”„λ μ„μ›ν¬λ¥Ό ν†µν•΄ κµ¬ν„λ LLM κΈ°λ° Multi-Character Role Playing μ‹μ¤ν…μ„ Chat Interfaceμ—μ„ μ‚¬μ©ν•΄ λ³Ό μ μλ„λ΅ Flask κΈ°λ° μ›Ή μ„λ²„ + HTMLμ„ ν†µν•΄ κµ¬ν„ν•μ€μµλ‹λ‹¤.

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

**μ¤‘μ”**: μ΄ μ• ν”λ¦¬μΌ€μ΄μ…μ€ λ…λ¦½μ μΌλ΅ μ‘λ™ν•μ§€ μ•μµλ‹λ‹¤. Neeko ν”„λ μ„μ›ν¬κ°€ μ•„λ‹λ”λΌλ„, μ‚¬μ©μμ μ…λ ¥μ— λ€ν•΄ μ μ ν• μ¶λ ¥μ„ λ°ν™ν•λ” API μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•λ” **λ³„λ„μ μ„λ²„κ°€ ν•„μμ μΌλ΅ ν•„μ”**ν•©λ‹λ‹¤.

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    HTTP API     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                 β”‚   β—„β”€β”€β”€β”€β”€β”€β”€β”€β–Ί    β”‚                 β”‚
β”‚   MCRP-demo     β”‚                 β”‚   AI μ„λ²„        β”‚
β”‚  (μ›Ή μΈν„°νμ΄μ¤)   β”‚                 β”‚ (ChatBot Engine)β”‚
β”‚                 β”‚                 β”‚                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                                   β”‚
        β”‚                                   β”‚
   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
   β”‚ μ‚¬μ©μ    β”‚                         β”‚ LLM/AI  β”‚
   β”‚ λΈλΌμ°μ €  β”‚                         β”‚ Model   β”‚
   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μ—­ν•  λ¶„λ‹΄

- **MCRP-demo (μ΄ ν”„λ΅μ νΈ)**:

  - μ›Ή κΈ°λ° μ‚¬μ©μ μΈν„°νμ΄μ¤ μ κ³µ
  - μ±„ν… νμ¤ν† λ¦¬ κ΄€λ¦¬
  - μΊλ¦­ν„° μ„ νƒ μΈν„°νμ΄μ¤
  - AI μ„λ²„μ™€μ ν†µμ‹  μ¤‘κ³„

- **AI μ„λ²„ (λ³„λ„ ν•„μ”)**:
  - μ‹¤μ  AI/LLM λ¨λΈ νΈμ¤ν…
  - Neeko ν”„λ μ„μ›ν¬ κΈ°λ° μΊλ¦­ν„°λ³„ νλ¥΄μ†λ‚ κµ¬ν„
  - μμ—°μ–΄ μ²λ¦¬ λ° μ‘λ‹µ μƒμ„±

## β οΈ μ‚¬μ „ μ”κµ¬μ‚¬ν•­

μ΄ μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ©ν•κΈ° μ „μ— **λ°λ“μ‹ AI μ„λ²„κ°€ μ¤€λΉ„λμ–΄μ•Ό ν•©λ‹λ‹¤**.

### AI μ„λ²„ μ”κµ¬μ‚¬ν•­

1. **OpenAPI λ…μ„Έ μ¤€μ**: AI μ„λ²„λ” μ§€μ •λ API μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•΄μ•Ό ν•©λ‹λ‹¤
2. **λ©€ν‹° μΊλ¦­ν„° μ§€μ›**: 9κ° μΊλ¦­ν„° νλ¥΄μ†λ‚ κµ¬ν„
3. **HTTP API μ κ³µ**: RESTful APIλ¥Ό ν†µν• ν†µμ‹  μ§€μ›

### AI μ„λ²„κ°€ μ—†λ” κ²½μ°

AI μ„λ²„κ°€ μ¤€λΉ„λμ§€ μ•μ€ μƒνƒμ—μ„λ”:

- β μ‹¤μ  AI μ‘λ‹µμ„ λ°›μ„ μ μ—†μµλ‹λ‹¤
- β… μ›Ή μΈν„°νμ΄μ¤λ” μ •μƒ μ‘λ™ν•λ©° μ‹λ®¬λ μ΄μ… μ‘λ‹µμ„ μ κ³µν•©λ‹λ‹¤
- β… κ°λ° λ° ν…μ¤νΈ λ©μ μΌλ΅ μ‚¬μ© κ°€λ¥ν•©λ‹λ‹¤

## β¨ μ£Όμ” κΈ°λ¥

- π­ **λ©€ν‹° μΊλ¦­ν„° μ‹μ¤ν…**: 9κ°μ μ„λ΅ λ‹¤λ¥Έ AI μΊλ¦­ν„° μ„ νƒ κ°€λ¥
- π’¬ **μ‹¤μ‹κ°„ μ±„ν…**: μμ—°μ¤λ¬μ΄ λ€ν™”ν• μΈν„°νμ΄μ¤
- π“± **λ°μ‘ν• λ””μμΈ**: λ¨λ°”μΌκ³Ό λ°μ¤ν¬ν†± λ¨λ‘ μ§€μ›
- π’Ύ **μ±„ν… νμ¤ν† λ¦¬**: λ€ν™” λ‚΄μ© μλ™ μ €μ¥ λ° κ΄€λ¦¬
- π³ **Docker μ§€μ›**: κ°„νΈν• λ°°ν¬ λ° μ‹¤ν–‰
- π”§ **ν™κ²½λ³€μ μ„¤μ •**: μ μ—°ν• μ„λ²„ κµ¬μ„±

## π­ μ§€μ› μΊλ¦­ν„°

LLM κΈ°λ° Chatμ„ μ κ³µν•λ” API μ„λ²„κ°€ Neeko ν”„λ μ„μ›ν¬λ¥Ό κΈ°λ°μΌλ΅ κµ¬ν„λμ–΄ μμΌλ―€λ΅, Neeko ν”„λ μ„μ›ν¬μ—μ„ μ‚¬μ©λ Character-LLM(https://github.com/choosewhatulike/trainable-agents) λ°μ΄ν„°μ…‹μ— ν¬ν•¨λ 9κ° μΊλ¦­ν„°μ™€μ μ±„ν…μ„ μ§€μ›ν•©λ‹λ‹¤.

- πΌ **Beethoven** - μμ•…μ κ±°μ¥
- π‘‘ **Caesar** - λ΅λ§μ ν™©μ 
- π **Cleopatra** - μ΄μ§‘νΈμ μ—¬μ™•
- π“ **Hermione** - λ§λ²•μ‚¬
- β **Martin** - μ‹λ―Όκ¶ μ΄λ™κ°€
- π **Newton** - λ¬Όλ¦¬ν•™μ
- π¤” **Socrates** - μ² ν•™μ
- β”οΈ **Spartacus** - κ²€ν¬μ‚¬
- π **Voldemort** - μ–΄λ‘ μ λ§λ²•μ‚¬

## π€ λΉ λ¥Έ μ‹μ‘

### 1λ‹¨κ³„: AI μ„λ²„ μ¤€λΉ„

**ν•„μ**: λ¨Όμ € AI μ„λ²„λ¥Ό μ¤€λΉ„ν•κ³  μ‹¤ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.

AI μ„λ²„λ” λ‹¤μ μ”κµ¬μ‚¬ν•­μ„ λ§μ΅±ν•΄μ•Ό ν•©λ‹λ‹¤:

- ν¬νΈμ—μ„ HTTP API μ„λΉ„μ¤ μ κ³µ
- μ•„λ λ…μ‹λ OpenAPI μ—”λ“ν¬μΈνΈ κµ¬ν„
- 9κ° μΊλ¦­ν„° νλ¥΄μ†λ‚ μ§€μ›

### 2λ‹¨κ³„: MCRP-demo μ‹¤ν–‰

#### Docker μ‚¬μ© (κ¶μ¥)

```bash
# μ €μ¥μ† ν΄λ΅ 
git clone <your-repository-url>
cd mcrp-demo

# ν™κ²½λ³€μ μ„¤μ •
cp env.example .env

# .env νμΌμ—μ„ AI μ„λ²„ μ •λ³΄ μ„¤μ •
# EXTERNAL_API_BASE=http://your-ai-server:port
nano .env

# Docker Composeλ΅ μ‹¤ν–‰
docker-compose up -d

# μ›Ή λΈλΌμ°μ €μ—μ„ http://localhost:5001 μ ‘μ†
```

#### λ΅μ»¬ κ°λ° ν™κ²½

```bash
# Python κ°€μƒν™κ²½ μƒμ„±
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt

# ν™κ²½λ³€μ μ„¤μ •
export EXTERNAL_API_BASE=http://your-ai-server:port
export FLASK_DEBUG=true

# μ„λ²„ μ‹¤ν–‰
python app.py
```

## β™οΈ ν™κ²½λ³€μ μ„¤μ •

ν”„λ΅μ νΈμ—μ„ μ‚¬μ©ν•λ” μ£Όμ” ν™κ²½λ³€μλ“¤:

| λ³€μλ…              | κΈ°λ³Έκ°’                  | μ„¤λ…                      |
| ------------------- | ----------------------- | ------------------------- |
| `EXTERNAL_API_BASE` | `http://localhost:8000` | **AI μ„λ²„ μ£Όμ† (ν•„μ)**   |
| `AI_API_TIMEOUT`    | `10`                    | AI API μ”μ²­ νƒ€μ„μ•„μ›ƒ (μ΄) |
| `FLASK_HOST`        | `0.0.0.0`               | Flask μ„λ²„ νΈμ¤νΈ         |
| `FLASK_PORT`        | `5001`                  | Flask μ„λ²„ ν¬νΈ           |
| `FLASK_DEBUG`       | `false`                 | λ””λ²„κ·Έ λ¨λ“               |
| `DATA_DIR`          | `./chat_data`           | μ±„ν… λ°μ΄ν„° μ €μ¥ κ²½λ΅     |

## π—οΈ ν”„λ΅μ νΈ κµ¬μ΅°

```
mcrp-demo/
β”β”€β”€ app.py                 # λ©”μΈ Flask μ• ν”λ¦¬μΌ€μ΄μ…
β”β”€β”€ requirements.txt       # Python μμ΅΄μ„±
β”β”€β”€ Dockerfile            # Docker μ΄λ―Έμ§€ μ„¤μ •
β”β”€β”€ docker-compose.yml    # Docker Compose μ„¤μ •
β”β”€β”€ index.html           # ν”„λ΅ νΈμ—”λ“ (SPA)
β”β”€β”€ main.css            # μ¤νƒ€μΌμ‹νΈ
β”β”€β”€ images/             # μΊλ¦­ν„° μ΄λ―Έμ§€
β”‚   β””β”€β”€ characters/
β”β”€β”€ chat_data/          # μ±„ν… λ°μ΄ν„° μ €μ¥μ†
β””β”€β”€ README.md           # ν”„λ΅μ νΈ λ¬Έμ„
```

## π” AI μ„λ²„ μ—°λ™ (OpenAPI λ…μ„Έ)

μ΄ μ• ν”λ¦¬μΌ€μ΄μ…μ€ **μ™Έλ¶€ AI μ„λ²„μ™€ μ—°λ™ν•μ—¬ μ‘λ™**ν•©λ‹λ‹¤. AI μ„λ²„λ” **λ°λ“μ‹** λ‹¤μ OpenAPI λ…μ„Έλ¥Ό μ¤€μν•΄μ•Ό ν•©λ‹λ‹¤:

### ν•„μ API μ—”λ“ν¬μΈνΈ

#### 1. μΊλ¦­ν„° λ©λ΅ μ΅°ν

```http
GET /characters
Content-Type: application/json
```

**μ‘λ‹µ μμ‹:**

```json
{
  "characters": [
    {
      "number": 1,
      "name": "Beethoven",
      "description": "μμ•…μ κ±°μ¥ λ² ν† λ²¤"
    },
    {
      "number": 2,
      "name": "Caesar",
      "description": "λ΅λ§μ ν™©μ  μ‹μ €"
    }
    // ... μ΄ 9κ° μΊλ¦­ν„°
  ]
}
```

#### 2. μΊλ¦­ν„° μ„ νƒ

```http
POST /select_character
Content-Type: application/json

{
  "character_number": 1
}
```

**μ‘λ‹µ μμ‹:**

```json
{
  "selected_character": "Beethoven",
  "message": "λ² ν† λ²¤μ΄ μ„ νƒλμ—μµλ‹λ‹¤."
}
```

#### 3. μ±„ν… μ‘λ‹µ μƒμ„±

```http
POST /generate
Content-Type: application/json

{
  "input_text": [
    {
      "role": "Man",
      "action": "(speaking)",
      "content": "μ•λ…•ν•μ„Έμ”!"
    }
  ],
  "max_new_tokens": 1024,
  "temperature": 1.0
}
```

**μ‘λ‹µ μμ‹:**

```json
{
  "generated_text": "Hello, My name is Beethoven.",
  "character": "Beethoven",
  "action": "(speaking)"
}
```

### API νΈμ¶ μμ‹

```python
# μΊλ¦­ν„° λ©λ΅ μ΅°ν
response = requests.get(f"{AI_SERVER_BASE}/characters")

# μΊλ¦­ν„° μ„ νƒ
response = requests.post(f"{AI_SERVER_BASE}/select_character",
                        json={"character_number": 1})

# μ±„ν… μ‘λ‹µ μƒμ„±
response = requests.post(f"{AI_SERVER_BASE}/generate",
                        json={
                          "input_text": conversation_history,
                          "max_new_tokens": 1024,
                          "temperature": 1.0
                        })
```

## π³ Docker μ‚¬μ©λ²•

μμ„Έν• Docker μ‚¬μ©λ²•μ€ [README_DOCKER.md](README_DOCKER.md)λ¥Ό μ°Έμ΅°ν•μ„Έμ”.

```bash
# κΈ°λ³Έ μ‹¤ν–‰
docker-compose up -d

# κ°λ° λ¨λ“λ΅ μ‹¤ν–‰
FLASK_DEBUG=true docker-compose up

# λ΅κ·Έ ν™•μΈ
docker-compose logs -f

# μ •λ¦¬
docker-compose down
```

## π“ κ°λ° κ°€μ΄λ“

### μ½”λ“ κµ¬μ΅°

- **Flask λ°±μ—”λ“**: RESTful API μ κ³µ, AI μ„λ²„μ™€μ μ¤‘κ³„ μ—­ν• 
- **λ°”λ‹λΌ JavaScript ν”„λ΅ νΈμ—”λ“**: SPA (Single Page Application)
- **JSON κΈ°λ° λ°μ΄ν„° μ €μ¥**: νμΌ μ‹μ¤ν… μ‚¬μ© (μ±„ν… νμ¤ν† λ¦¬)
- **Gunicorn**: μ΄μ ν™κ²½μ© WSGI μ„λ²„

### μ£Όμ” API μ—”λ“ν¬μΈνΈ

- `GET /api/chats` - μ±„ν… λ©λ΅ μ΅°ν
- `POST /api/chats` - μƒ μ±„ν… μƒμ„±
- `GET /api/chats/{id}` - νΉμ • μ±„ν… μ΅°ν
- `DELETE /api/chats/{id}` - μ±„ν… μ‚­μ 
- `POST /api/chat` - λ©”μ‹μ§€ μ „μ†΅ (AI μ„λ²„λ΅ μ¤‘κ³„)
- `GET /api/characters` - μΊλ¦­ν„° λ©λ΅ μ΅°ν (AI μ„λ²„μ—μ„ κ°€μ Έμ΄)

### κ°λ° μ‹ μ£Όμμ‚¬ν•­

1. **AI μ„λ²„ μμ΅΄μ„±**: λ¨λ“  AI κ΄€λ ¨ κΈ°λ¥μ€ μ™Έλ¶€ AI μ„λ²„μ— μμ΅΄ν•©λ‹λ‹¤
2. **μ—λ¬ μ²λ¦¬**: AI μ„λ²„ μ—°κ²° μ‹¤ν¨ μ‹ μ‹λ®¬λ μ΄μ… μ‘λ‹µμΌλ΅ λ€μ²΄λ©λ‹λ‹¤
3. **μ‹κ°„ μ΄κ³Ό**: AI_API_TIMEOUT μ„¤μ •μΌλ΅ μ‘λ‹µ μ‹κ°„μ„ μ ν•ν•©λ‹λ‹¤

## π› οΈ λ¬Έμ  ν•΄κ²°

### μΌλ°μ μΈ λ¬Έμ λ“¤

1. **AI μ„λ²„ μ—°κ²° μ‹¤ν¨**

   - `EXTERNAL_API_BASE` ν™κ²½λ³€μ ν™•μΈ
   - AI μ„λ²„ μƒνƒ λ° λ„¤νΈμ›ν¬ μ—°κ²° ν™•μΈ
   - AI μ„λ²„μ OpenAPI μ—”λ“ν¬μΈνΈ κµ¬ν„ μƒνƒ ν™•μΈ

2. **μΊλ¦­ν„° μ„ νƒ μ•λ¨**

   - AI μ„λ²„μ `/characters` μ—”λ“ν¬μΈνΈ ν™•μΈ
   - AI μ„λ²„μ `/select_character` μ—”λ“ν¬μΈνΈ ν™•μΈ

3. **AI μ‘λ‹µ μ—†μ**

   - AI μ„λ²„μ `/generate` μ—”λ“ν¬μΈνΈ ν™•μΈ
   - μ”μ²­ ν•μ‹μ΄ OpenAPI λ…μ„Έμ™€ μΌμΉν•λ”μ§€ ν™•μΈ

4. **ν¬νΈ μ¶©λ**

   - `HOST_PORT` ν™κ²½λ³€μλ΅ λ‹¤λ¥Έ ν¬νΈ μ‚¬μ©

5. **κ¶ν• λ¬Έμ **
   - `DATA_DIR` λ””λ ‰ν† λ¦¬ κ¶ν• ν™•μΈ

### λ””λ²„κΉ… ν

```bash
# AI μ„λ²„ μ—°κ²° ν…μ¤νΈ
curl http://your-ai-server:port/characters

# λ΅κ·Έ ν™•μΈ
docker-compose logs -f mcrp-demo

# κ°λ° λ¨λ“λ΅ μƒμ„Έ λ΅κ·Έ ν™•μΈ
FLASK_DEBUG=true docker-compose up
```
